<!DOCTYPE html>
<html>
	<head>
		<title>Vector Tiles in OpenLayers 3.18.2</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/ol3/3.18.2/ol-debug.css" />
		<style type="text/css">
			html, body, #map {
				margin: 0;
				height: 100%;
			}
		</style>
	</head>
	<body>
		<div id="map"></div>
		<script src="//cdnjs.cloudflare.com/ajax/libs/ol3/3.18.2/ol-debug.js"></script>
		<script src="http://openlayers.org/en/v3.18.2/examples/resources/mapbox-streets-v6-style.js"></script>
		<script>
			var styleCache = {};

			var styleFunction = function(feature, resolution) {
				var color = feature.get('COLOR_LINIA');
				if (!styleCache.hasOwnProperty(color)) {
					styleCache[color] = new ol.style.Style({
						stroke: new ol.style.Stroke({
							color: '#' + color,
							width: 5
						})
					});
				}
				return styleCache[color];
			}

			var map = new ol.Map({
				layers: [
					new ol.layer.VectorTile({
						source: new ol.source.VectorTile({
							attributions: '© <a href="http://www.openstreetmap.org/copyright">OpenStreetMap contributors</a>',
							format: new ol.format.MVT(),
							tileGrid: ol.tilegrid.createXYZ({maxZoom: 22}),
							tilePixelRatio: 16,
							url: 'http://vertex.fonts.cat:8081/data/osm2vectortiles/{z}/{x}/{y}.pbf'
						}),
						style: createMapboxStreetsV6Style()
					}),
					new ol.layer.VectorTile({
						source: new ol.source.VectorTile({
							attributions: '© <a href="http://www.tmb.cat">TMB</a>',
							format: new ol.format.MVT(),
							tileGrid: ol.tilegrid.createXYZ({maxZoom: 22}),
							tilePixelRatio: 1,
							url: 'http://vertex.fonts.cat:8080/geoserver/gwc/service/tms/1.0.0/TMB%3ALINIES_METRO@EPSG%3A900913@pbf/{z}/{x}/{-y}.pbf'
						}),
						style: styleFunction
					})
				],
				target: 'map',
				view: new ol.View({
					center: ol.proj.transform([2.1756, 41.3949], 'EPSG:4326', 'EPSG:3857'),
					rotation: Math.PI / 4,
					zoom: 14
				})
			});
		</script>
	</body>
</html>
